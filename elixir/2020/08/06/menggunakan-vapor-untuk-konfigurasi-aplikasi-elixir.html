<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Menggunakan vapor untuk konfigurasi aplikasi elixir | susilolab</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Menggunakan vapor untuk konfigurasi aplikasi elixir" />
<meta name="author" content="Agus Susilo" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Assalamu’alaikum teman-teman, kali saya ingin sedikit berbagi tentang Vapor. Bagi yang belum tahu, vapor adalah pustaka untuk mengatur konfigurasi pada aplikasi yang dibuat dengan bahasa Elixir. Kenapa menggunakan vapor? Pertama, karena saya mengalami sesuatu yang tidak biasa pada saat mendeploy aplikasi di server production sehingga mengharuskan saya untuk meggunakan config lain yang bukan official. Kedua karena vapor lebih fleksibel, vapor dapat membaca konfigurasi dari beberapa provider seperti .env, file json, toml dan yaml bahkan juga dapat membaca dari variabel environmen. Ok langsung saja, untuk menggunakan vapor pertama tambahkan library ke daftar dependency di file mix.exs ... defp deps do [ ... {:vapor, &quot;~&gt; 0.9&quot;} ] end ... Setelah library sudah kita tambahkan ke file mix.exs, langkah selanjutnya adalah menggunakan vapor pada bagian bootstrap. Aplikasi elixir yang digenerate mix dengan tambahan opsi --sup akan memiliki file nama_app/lib/nama_app/application.ex. Nah kita akan menggunakan vapor pada file tersebut. Pada contoh pertama ini kita akan membaca konfig dari file .env. Sebelumnya buat file .env terlebih dahulu file pada root folder aplikasi. Isinya seperti ini: DB_NAME=myapp DB_USER=root DB_PASS= DB_HOST=localhost Untuk mengurangi pengetikan sebaiknya kita gunakan keyword use untuk memperpendek nama modul. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... end Kemudian buat binding dengan Dotenv karena kita akan menggunakan file .env untuk menyimpan konfigurasi. Lalu simpan hasil load konfig ke variabel config. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... def start(_type, _args) do providers =[ %Dotenv{bindings: [ {:db_name, &quot;DB_NAME&quot;}, {:db_user, &quot;DB_USER&quot;}, {:db_pass, &quot;DB_PASS&quot;}, {:db_host, &quot;DB_HOST&quot;} ]} ] config = Vapor.load!(providers) end ... end Sampai di sini kita sudah bisa menggunakan hasil load konfigurasi vapor yang sudah disimpan pada variabel config, misal butuh nama database tinggal panggil config.db_name. Misalnya kita bisa menggunakan pada saat modul Repo akan diset ke supervisor. Lihat contoh berikut ini: defmodule Myapp.Application do ... def start(_type, _args) do ... children = [ {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ]}, ... ] ... end ... end Pada contoh kedua kita akan menggunakan file json sebagai tempat untuk menyimpan konfigurasi aplikasi. Sebelumnya buat dulu file jsonnya misal namanya config.json lalu simpan sejajar dengan folder lib. Kemudian copy paste kode berikut ini. { &quot;db_name&quot;: &quot;db_name&quot;, &quot;db_user&quot;: &quot;username&quot;, &quot;db_pass&quot;: &quot;password&quot;, &quot;db_host&quot;: &quot;localhost&quot; } Kemudian masuk ke kode elixir, ganti use modul Dotenv menjadi File. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do providers =[ %File{ path: System.get_env(&quot;MYAPP_PATH&quot;) &lt;&gt; &quot;config.json&quot;, bindings: [ {:db_name, &quot;db_name&quot;}, {:db_user, &quot;db_user&quot;}, {:db_pass, &quot;db_pass&quot;}, {:db_host, &quot;db_host&quot;} ] } ] config = Vapor.load!(providers) end ... end Setelah fungsi Vapor.load!() dipanggil dan dimasukkan ke variabel config maka kita bisa menggunakan config tersebut kedalam definisi children supervisor. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do ... children = [ ... {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ] } ... ] ... end end Untuk menjalankan aplikasi kita perlu menset variabel shell MYAPP_PATH sesuai dengan lokasi aplikasinya. Dengan menggunakan config file membuat aplikasi kita akan lebih mudah dalam mengganti konfigurasinya. Sekian tips dari saya semoga bermanfaat." />
<meta property="og:description" content="Assalamu’alaikum teman-teman, kali saya ingin sedikit berbagi tentang Vapor. Bagi yang belum tahu, vapor adalah pustaka untuk mengatur konfigurasi pada aplikasi yang dibuat dengan bahasa Elixir. Kenapa menggunakan vapor? Pertama, karena saya mengalami sesuatu yang tidak biasa pada saat mendeploy aplikasi di server production sehingga mengharuskan saya untuk meggunakan config lain yang bukan official. Kedua karena vapor lebih fleksibel, vapor dapat membaca konfigurasi dari beberapa provider seperti .env, file json, toml dan yaml bahkan juga dapat membaca dari variabel environmen. Ok langsung saja, untuk menggunakan vapor pertama tambahkan library ke daftar dependency di file mix.exs ... defp deps do [ ... {:vapor, &quot;~&gt; 0.9&quot;} ] end ... Setelah library sudah kita tambahkan ke file mix.exs, langkah selanjutnya adalah menggunakan vapor pada bagian bootstrap. Aplikasi elixir yang digenerate mix dengan tambahan opsi --sup akan memiliki file nama_app/lib/nama_app/application.ex. Nah kita akan menggunakan vapor pada file tersebut. Pada contoh pertama ini kita akan membaca konfig dari file .env. Sebelumnya buat file .env terlebih dahulu file pada root folder aplikasi. Isinya seperti ini: DB_NAME=myapp DB_USER=root DB_PASS= DB_HOST=localhost Untuk mengurangi pengetikan sebaiknya kita gunakan keyword use untuk memperpendek nama modul. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... end Kemudian buat binding dengan Dotenv karena kita akan menggunakan file .env untuk menyimpan konfigurasi. Lalu simpan hasil load konfig ke variabel config. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... def start(_type, _args) do providers =[ %Dotenv{bindings: [ {:db_name, &quot;DB_NAME&quot;}, {:db_user, &quot;DB_USER&quot;}, {:db_pass, &quot;DB_PASS&quot;}, {:db_host, &quot;DB_HOST&quot;} ]} ] config = Vapor.load!(providers) end ... end Sampai di sini kita sudah bisa menggunakan hasil load konfigurasi vapor yang sudah disimpan pada variabel config, misal butuh nama database tinggal panggil config.db_name. Misalnya kita bisa menggunakan pada saat modul Repo akan diset ke supervisor. Lihat contoh berikut ini: defmodule Myapp.Application do ... def start(_type, _args) do ... children = [ {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ]}, ... ] ... end ... end Pada contoh kedua kita akan menggunakan file json sebagai tempat untuk menyimpan konfigurasi aplikasi. Sebelumnya buat dulu file jsonnya misal namanya config.json lalu simpan sejajar dengan folder lib. Kemudian copy paste kode berikut ini. { &quot;db_name&quot;: &quot;db_name&quot;, &quot;db_user&quot;: &quot;username&quot;, &quot;db_pass&quot;: &quot;password&quot;, &quot;db_host&quot;: &quot;localhost&quot; } Kemudian masuk ke kode elixir, ganti use modul Dotenv menjadi File. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do providers =[ %File{ path: System.get_env(&quot;MYAPP_PATH&quot;) &lt;&gt; &quot;config.json&quot;, bindings: [ {:db_name, &quot;db_name&quot;}, {:db_user, &quot;db_user&quot;}, {:db_pass, &quot;db_pass&quot;}, {:db_host, &quot;db_host&quot;} ] } ] config = Vapor.load!(providers) end ... end Setelah fungsi Vapor.load!() dipanggil dan dimasukkan ke variabel config maka kita bisa menggunakan config tersebut kedalam definisi children supervisor. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do ... children = [ ... {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ] } ... ] ... end end Untuk menjalankan aplikasi kita perlu menset variabel shell MYAPP_PATH sesuai dengan lokasi aplikasinya. Dengan menggunakan config file membuat aplikasi kita akan lebih mudah dalam mengganti konfigurasinya. Sekian tips dari saya semoga bermanfaat." />
<link rel="canonical" href="https://susilolab.github.io/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html" />
<meta property="og:url" content="https://susilolab.github.io/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html" />
<meta property="og:site_name" content="susilolab" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-06T07:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Menggunakan vapor untuk konfigurasi aplikasi elixir" />
<script type="application/ld+json">
{"headline":"Menggunakan vapor untuk konfigurasi aplikasi elixir","dateModified":"2020-08-06T07:00:00+07:00","datePublished":"2020-08-06T07:00:00+07:00","url":"https://susilolab.github.io/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html","author":{"@type":"Person","name":"Agus Susilo"},"description":"Assalamu’alaikum teman-teman, kali saya ingin sedikit berbagi tentang Vapor. Bagi yang belum tahu, vapor adalah pustaka untuk mengatur konfigurasi pada aplikasi yang dibuat dengan bahasa Elixir. Kenapa menggunakan vapor? Pertama, karena saya mengalami sesuatu yang tidak biasa pada saat mendeploy aplikasi di server production sehingga mengharuskan saya untuk meggunakan config lain yang bukan official. Kedua karena vapor lebih fleksibel, vapor dapat membaca konfigurasi dari beberapa provider seperti .env, file json, toml dan yaml bahkan juga dapat membaca dari variabel environmen. Ok langsung saja, untuk menggunakan vapor pertama tambahkan library ke daftar dependency di file mix.exs ... defp deps do [ ... {:vapor, &quot;~&gt; 0.9&quot;} ] end ... Setelah library sudah kita tambahkan ke file mix.exs, langkah selanjutnya adalah menggunakan vapor pada bagian bootstrap. Aplikasi elixir yang digenerate mix dengan tambahan opsi --sup akan memiliki file nama_app/lib/nama_app/application.ex. Nah kita akan menggunakan vapor pada file tersebut. Pada contoh pertama ini kita akan membaca konfig dari file .env. Sebelumnya buat file .env terlebih dahulu file pada root folder aplikasi. Isinya seperti ini: DB_NAME=myapp DB_USER=root DB_PASS= DB_HOST=localhost Untuk mengurangi pengetikan sebaiknya kita gunakan keyword use untuk memperpendek nama modul. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... end Kemudian buat binding dengan Dotenv karena kita akan menggunakan file .env untuk menyimpan konfigurasi. Lalu simpan hasil load konfig ke variabel config. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... def start(_type, _args) do providers =[ %Dotenv{bindings: [ {:db_name, &quot;DB_NAME&quot;}, {:db_user, &quot;DB_USER&quot;}, {:db_pass, &quot;DB_PASS&quot;}, {:db_host, &quot;DB_HOST&quot;} ]} ] config = Vapor.load!(providers) end ... end Sampai di sini kita sudah bisa menggunakan hasil load konfigurasi vapor yang sudah disimpan pada variabel config, misal butuh nama database tinggal panggil config.db_name. Misalnya kita bisa menggunakan pada saat modul Repo akan diset ke supervisor. Lihat contoh berikut ini: defmodule Myapp.Application do ... def start(_type, _args) do ... children = [ {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ]}, ... ] ... end ... end Pada contoh kedua kita akan menggunakan file json sebagai tempat untuk menyimpan konfigurasi aplikasi. Sebelumnya buat dulu file jsonnya misal namanya config.json lalu simpan sejajar dengan folder lib. Kemudian copy paste kode berikut ini. { &quot;db_name&quot;: &quot;db_name&quot;, &quot;db_user&quot;: &quot;username&quot;, &quot;db_pass&quot;: &quot;password&quot;, &quot;db_host&quot;: &quot;localhost&quot; } Kemudian masuk ke kode elixir, ganti use modul Dotenv menjadi File. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do providers =[ %File{ path: System.get_env(&quot;MYAPP_PATH&quot;) &lt;&gt; &quot;config.json&quot;, bindings: [ {:db_name, &quot;db_name&quot;}, {:db_user, &quot;db_user&quot;}, {:db_pass, &quot;db_pass&quot;}, {:db_host, &quot;db_host&quot;} ] } ] config = Vapor.load!(providers) end ... end Setelah fungsi Vapor.load!() dipanggil dan dimasukkan ke variabel config maka kita bisa menggunakan config tersebut kedalam definisi children supervisor. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do ... children = [ ... {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ] } ... ] ... end end Untuk menjalankan aplikasi kita perlu menset variabel shell MYAPP_PATH sesuai dengan lokasi aplikasinya. Dengan menggunakan config file membuat aplikasi kita akan lebih mudah dalam mengganti konfigurasinya. Sekian tips dari saya semoga bermanfaat.","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://susilolab.github.io/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://susilolab.github.io/feed.xml" title="susilolab" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-173956394-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Menggunakan vapor untuk konfigurasi aplikasi elixir | susilolab</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Menggunakan vapor untuk konfigurasi aplikasi elixir" />
<meta name="author" content="Agus Susilo" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Assalamu’alaikum teman-teman, kali saya ingin sedikit berbagi tentang Vapor. Bagi yang belum tahu, vapor adalah pustaka untuk mengatur konfigurasi pada aplikasi yang dibuat dengan bahasa Elixir. Kenapa menggunakan vapor? Pertama, karena saya mengalami sesuatu yang tidak biasa pada saat mendeploy aplikasi di server production sehingga mengharuskan saya untuk meggunakan config lain yang bukan official. Kedua karena vapor lebih fleksibel, vapor dapat membaca konfigurasi dari beberapa provider seperti .env, file json, toml dan yaml bahkan juga dapat membaca dari variabel environmen. Ok langsung saja, untuk menggunakan vapor pertama tambahkan library ke daftar dependency di file mix.exs ... defp deps do [ ... {:vapor, &quot;~&gt; 0.9&quot;} ] end ... Setelah library sudah kita tambahkan ke file mix.exs, langkah selanjutnya adalah menggunakan vapor pada bagian bootstrap. Aplikasi elixir yang digenerate mix dengan tambahan opsi --sup akan memiliki file nama_app/lib/nama_app/application.ex. Nah kita akan menggunakan vapor pada file tersebut. Pada contoh pertama ini kita akan membaca konfig dari file .env. Sebelumnya buat file .env terlebih dahulu file pada root folder aplikasi. Isinya seperti ini: DB_NAME=myapp DB_USER=root DB_PASS= DB_HOST=localhost Untuk mengurangi pengetikan sebaiknya kita gunakan keyword use untuk memperpendek nama modul. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... end Kemudian buat binding dengan Dotenv karena kita akan menggunakan file .env untuk menyimpan konfigurasi. Lalu simpan hasil load konfig ke variabel config. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... def start(_type, _args) do providers =[ %Dotenv{bindings: [ {:db_name, &quot;DB_NAME&quot;}, {:db_user, &quot;DB_USER&quot;}, {:db_pass, &quot;DB_PASS&quot;}, {:db_host, &quot;DB_HOST&quot;} ]} ] config = Vapor.load!(providers) end ... end Sampai di sini kita sudah bisa menggunakan hasil load konfigurasi vapor yang sudah disimpan pada variabel config, misal butuh nama database tinggal panggil config.db_name. Misalnya kita bisa menggunakan pada saat modul Repo akan diset ke supervisor. Lihat contoh berikut ini: defmodule Myapp.Application do ... def start(_type, _args) do ... children = [ {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ]}, ... ] ... end ... end Pada contoh kedua kita akan menggunakan file json sebagai tempat untuk menyimpan konfigurasi aplikasi. Sebelumnya buat dulu file jsonnya misal namanya config.json lalu simpan sejajar dengan folder lib. Kemudian copy paste kode berikut ini. { &quot;db_name&quot;: &quot;db_name&quot;, &quot;db_user&quot;: &quot;username&quot;, &quot;db_pass&quot;: &quot;password&quot;, &quot;db_host&quot;: &quot;localhost&quot; } Kemudian masuk ke kode elixir, ganti use modul Dotenv menjadi File. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do providers =[ %File{ path: System.get_env(&quot;MYAPP_PATH&quot;) &lt;&gt; &quot;config.json&quot;, bindings: [ {:db_name, &quot;db_name&quot;}, {:db_user, &quot;db_user&quot;}, {:db_pass, &quot;db_pass&quot;}, {:db_host, &quot;db_host&quot;} ] } ] config = Vapor.load!(providers) end ... end Setelah fungsi Vapor.load!() dipanggil dan dimasukkan ke variabel config maka kita bisa menggunakan config tersebut kedalam definisi children supervisor. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do ... children = [ ... {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ] } ... ] ... end end Untuk menjalankan aplikasi kita perlu menset variabel shell MYAPP_PATH sesuai dengan lokasi aplikasinya. Dengan menggunakan config file membuat aplikasi kita akan lebih mudah dalam mengganti konfigurasinya. Sekian tips dari saya semoga bermanfaat." />
<meta property="og:description" content="Assalamu’alaikum teman-teman, kali saya ingin sedikit berbagi tentang Vapor. Bagi yang belum tahu, vapor adalah pustaka untuk mengatur konfigurasi pada aplikasi yang dibuat dengan bahasa Elixir. Kenapa menggunakan vapor? Pertama, karena saya mengalami sesuatu yang tidak biasa pada saat mendeploy aplikasi di server production sehingga mengharuskan saya untuk meggunakan config lain yang bukan official. Kedua karena vapor lebih fleksibel, vapor dapat membaca konfigurasi dari beberapa provider seperti .env, file json, toml dan yaml bahkan juga dapat membaca dari variabel environmen. Ok langsung saja, untuk menggunakan vapor pertama tambahkan library ke daftar dependency di file mix.exs ... defp deps do [ ... {:vapor, &quot;~&gt; 0.9&quot;} ] end ... Setelah library sudah kita tambahkan ke file mix.exs, langkah selanjutnya adalah menggunakan vapor pada bagian bootstrap. Aplikasi elixir yang digenerate mix dengan tambahan opsi --sup akan memiliki file nama_app/lib/nama_app/application.ex. Nah kita akan menggunakan vapor pada file tersebut. Pada contoh pertama ini kita akan membaca konfig dari file .env. Sebelumnya buat file .env terlebih dahulu file pada root folder aplikasi. Isinya seperti ini: DB_NAME=myapp DB_USER=root DB_PASS= DB_HOST=localhost Untuk mengurangi pengetikan sebaiknya kita gunakan keyword use untuk memperpendek nama modul. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... end Kemudian buat binding dengan Dotenv karena kita akan menggunakan file .env untuk menyimpan konfigurasi. Lalu simpan hasil load konfig ke variabel config. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... def start(_type, _args) do providers =[ %Dotenv{bindings: [ {:db_name, &quot;DB_NAME&quot;}, {:db_user, &quot;DB_USER&quot;}, {:db_pass, &quot;DB_PASS&quot;}, {:db_host, &quot;DB_HOST&quot;} ]} ] config = Vapor.load!(providers) end ... end Sampai di sini kita sudah bisa menggunakan hasil load konfigurasi vapor yang sudah disimpan pada variabel config, misal butuh nama database tinggal panggil config.db_name. Misalnya kita bisa menggunakan pada saat modul Repo akan diset ke supervisor. Lihat contoh berikut ini: defmodule Myapp.Application do ... def start(_type, _args) do ... children = [ {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ]}, ... ] ... end ... end Pada contoh kedua kita akan menggunakan file json sebagai tempat untuk menyimpan konfigurasi aplikasi. Sebelumnya buat dulu file jsonnya misal namanya config.json lalu simpan sejajar dengan folder lib. Kemudian copy paste kode berikut ini. { &quot;db_name&quot;: &quot;db_name&quot;, &quot;db_user&quot;: &quot;username&quot;, &quot;db_pass&quot;: &quot;password&quot;, &quot;db_host&quot;: &quot;localhost&quot; } Kemudian masuk ke kode elixir, ganti use modul Dotenv menjadi File. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do providers =[ %File{ path: System.get_env(&quot;MYAPP_PATH&quot;) &lt;&gt; &quot;config.json&quot;, bindings: [ {:db_name, &quot;db_name&quot;}, {:db_user, &quot;db_user&quot;}, {:db_pass, &quot;db_pass&quot;}, {:db_host, &quot;db_host&quot;} ] } ] config = Vapor.load!(providers) end ... end Setelah fungsi Vapor.load!() dipanggil dan dimasukkan ke variabel config maka kita bisa menggunakan config tersebut kedalam definisi children supervisor. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do ... children = [ ... {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ] } ... ] ... end end Untuk menjalankan aplikasi kita perlu menset variabel shell MYAPP_PATH sesuai dengan lokasi aplikasinya. Dengan menggunakan config file membuat aplikasi kita akan lebih mudah dalam mengganti konfigurasinya. Sekian tips dari saya semoga bermanfaat." />
<link rel="canonical" href="https://susilolab.github.io/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html" />
<meta property="og:url" content="https://susilolab.github.io/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html" />
<meta property="og:site_name" content="susilolab" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-06T07:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Menggunakan vapor untuk konfigurasi aplikasi elixir" />
<script type="application/ld+json">
{"headline":"Menggunakan vapor untuk konfigurasi aplikasi elixir","dateModified":"2020-08-06T07:00:00+07:00","datePublished":"2020-08-06T07:00:00+07:00","url":"https://susilolab.github.io/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html","author":{"@type":"Person","name":"Agus Susilo"},"description":"Assalamu’alaikum teman-teman, kali saya ingin sedikit berbagi tentang Vapor. Bagi yang belum tahu, vapor adalah pustaka untuk mengatur konfigurasi pada aplikasi yang dibuat dengan bahasa Elixir. Kenapa menggunakan vapor? Pertama, karena saya mengalami sesuatu yang tidak biasa pada saat mendeploy aplikasi di server production sehingga mengharuskan saya untuk meggunakan config lain yang bukan official. Kedua karena vapor lebih fleksibel, vapor dapat membaca konfigurasi dari beberapa provider seperti .env, file json, toml dan yaml bahkan juga dapat membaca dari variabel environmen. Ok langsung saja, untuk menggunakan vapor pertama tambahkan library ke daftar dependency di file mix.exs ... defp deps do [ ... {:vapor, &quot;~&gt; 0.9&quot;} ] end ... Setelah library sudah kita tambahkan ke file mix.exs, langkah selanjutnya adalah menggunakan vapor pada bagian bootstrap. Aplikasi elixir yang digenerate mix dengan tambahan opsi --sup akan memiliki file nama_app/lib/nama_app/application.ex. Nah kita akan menggunakan vapor pada file tersebut. Pada contoh pertama ini kita akan membaca konfig dari file .env. Sebelumnya buat file .env terlebih dahulu file pada root folder aplikasi. Isinya seperti ini: DB_NAME=myapp DB_USER=root DB_PASS= DB_HOST=localhost Untuk mengurangi pengetikan sebaiknya kita gunakan keyword use untuk memperpendek nama modul. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... end Kemudian buat binding dengan Dotenv karena kita akan menggunakan file .env untuk menyimpan konfigurasi. Lalu simpan hasil load konfig ke variabel config. defmodule Myapp.Application do use Vapor.Provider.Dotenv ... def start(_type, _args) do providers =[ %Dotenv{bindings: [ {:db_name, &quot;DB_NAME&quot;}, {:db_user, &quot;DB_USER&quot;}, {:db_pass, &quot;DB_PASS&quot;}, {:db_host, &quot;DB_HOST&quot;} ]} ] config = Vapor.load!(providers) end ... end Sampai di sini kita sudah bisa menggunakan hasil load konfigurasi vapor yang sudah disimpan pada variabel config, misal butuh nama database tinggal panggil config.db_name. Misalnya kita bisa menggunakan pada saat modul Repo akan diset ke supervisor. Lihat contoh berikut ini: defmodule Myapp.Application do ... def start(_type, _args) do ... children = [ {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ]}, ... ] ... end ... end Pada contoh kedua kita akan menggunakan file json sebagai tempat untuk menyimpan konfigurasi aplikasi. Sebelumnya buat dulu file jsonnya misal namanya config.json lalu simpan sejajar dengan folder lib. Kemudian copy paste kode berikut ini. { &quot;db_name&quot;: &quot;db_name&quot;, &quot;db_user&quot;: &quot;username&quot;, &quot;db_pass&quot;: &quot;password&quot;, &quot;db_host&quot;: &quot;localhost&quot; } Kemudian masuk ke kode elixir, ganti use modul Dotenv menjadi File. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do providers =[ %File{ path: System.get_env(&quot;MYAPP_PATH&quot;) &lt;&gt; &quot;config.json&quot;, bindings: [ {:db_name, &quot;db_name&quot;}, {:db_user, &quot;db_user&quot;}, {:db_pass, &quot;db_pass&quot;}, {:db_host, &quot;db_host&quot;} ] } ] config = Vapor.load!(providers) end ... end Setelah fungsi Vapor.load!() dipanggil dan dimasukkan ke variabel config maka kita bisa menggunakan config tersebut kedalam definisi children supervisor. defmodule Myapp.Application do use Vapor.Provider.File ... def start(_type, _args) do ... children = [ ... {Myapp.Repo, [ database: config.db_name, username: config.db_user, password: config.db_pass, hostname: config.db_host ] } ... ] ... end end Untuk menjalankan aplikasi kita perlu menset variabel shell MYAPP_PATH sesuai dengan lokasi aplikasinya. Dengan menggunakan config file membuat aplikasi kita akan lebih mudah dalam mengganti konfigurasinya. Sekian tips dari saya semoga bermanfaat.","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://susilolab.github.io/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  
  







</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">susilolab</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/portfolio/">My Portfolio</a><a class="page-link" href="/rust-book/">Rust Book</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Menggunakan vapor untuk konfigurasi aplikasi elixir</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-08-06T07:00:00+07:00" itemprop="datePublished">Aug 6, 2020
      </time>
      
      
      • categories:  
      
      <a href="/categories/#elixir">elixir</a>
      
      
      </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Assalamu’alaikum teman-teman, kali saya ingin sedikit berbagi tentang <a href="https://github.com/keathley/vapor">Vapor</a>. Bagi yang belum tahu, vapor adalah pustaka untuk mengatur konfigurasi pada aplikasi yang dibuat dengan bahasa Elixir.</p>

<p>Kenapa menggunakan vapor? Pertama, karena saya mengalami sesuatu yang tidak biasa pada saat mendeploy aplikasi di server production sehingga mengharuskan saya untuk meggunakan config lain yang bukan official. Kedua karena vapor lebih fleksibel, vapor dapat membaca konfigurasi dari beberapa provider seperti <code class="language-plaintext highlighter-rouge">.env</code>, file json, toml dan yaml bahkan juga dapat membaca dari variabel environmen.</p>

<p>Ok langsung saja, untuk menggunakan vapor pertama tambahkan library ke daftar dependency di file <code class="language-plaintext highlighter-rouge">mix.exs</code></p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="o">...</span>
  <span class="k">defp</span> <span class="n">deps</span> <span class="k">do</span>
    <span class="p">[</span>
      <span class="o">...</span>
      <span class="p">{</span><span class="ss">:vapor</span><span class="p">,</span> <span class="s2">"~&gt; 0.9"</span><span class="p">}</span>
    <span class="p">]</span>
  <span class="k">end</span>
<span class="o">...</span></code></pre></figure>

<p>Setelah library sudah kita tambahkan ke file <code class="language-plaintext highlighter-rouge">mix.exs</code>, langkah selanjutnya adalah menggunakan vapor pada bagian bootstrap. Aplikasi elixir yang digenerate mix dengan tambahan opsi <code class="language-plaintext highlighter-rouge">--sup</code> akan memiliki file <code class="language-plaintext highlighter-rouge">nama_app/lib/nama_app/application.ex</code>. Nah kita akan menggunakan vapor pada file tersebut.</p>

<p>Pada contoh pertama ini kita akan membaca konfig dari file <code class="language-plaintext highlighter-rouge">.env</code>. Sebelumnya buat file <code class="language-plaintext highlighter-rouge">.env</code> terlebih dahulu file pada root folder aplikasi.
Isinya seperti ini:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">DB_NAME</span><span class="o">=</span>myapp
<span class="nv">DB_USER</span><span class="o">=</span>root
<span class="nv">DB_PASS</span><span class="o">=</span>
<span class="nv">DB_HOST</span><span class="o">=</span>localhost</code></pre></figure>

<p>Untuk mengurangi pengetikan sebaiknya kita gunakan keyword <code class="language-plaintext highlighter-rouge">use</code> untuk memperpendek nama modul.</p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="k">defmodule</span> <span class="no">Myapp</span><span class="o">.</span><span class="no">Application</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Vapor</span><span class="o">.</span><span class="no">Provider</span><span class="o">.</span><span class="no">Dotenv</span>
  <span class="o">...</span>
<span class="k">end</span></code></pre></figure>

<p>Kemudian buat binding dengan <code class="language-plaintext highlighter-rouge">Dotenv</code> karena kita akan menggunakan file <code class="language-plaintext highlighter-rouge">.env</code> untuk menyimpan konfigurasi. Lalu simpan hasil load konfig ke variabel <code class="language-plaintext highlighter-rouge">config</code>.</p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="k">defmodule</span> <span class="no">Myapp</span><span class="o">.</span><span class="no">Application</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Vapor</span><span class="o">.</span><span class="no">Provider</span><span class="o">.</span><span class="no">Dotenv</span>
  <span class="o">...</span>
  <span class="k">def</span> <span class="n">start</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="n">_args</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">providers</span> <span class="o">=</span><span class="p">[</span>
      <span class="p">%</span><span class="no">Dotenv</span><span class="p">{</span><span class="ss">bindings:</span> <span class="p">[</span>
        <span class="p">{</span><span class="ss">:db_name</span><span class="p">,</span> <span class="s2">"DB_NAME"</span><span class="p">},</span>
        <span class="p">{</span><span class="ss">:db_user</span><span class="p">,</span> <span class="s2">"DB_USER"</span><span class="p">},</span>
        <span class="p">{</span><span class="ss">:db_pass</span><span class="p">,</span> <span class="s2">"DB_PASS"</span><span class="p">},</span>
        <span class="p">{</span><span class="ss">:db_host</span><span class="p">,</span> <span class="s2">"DB_HOST"</span><span class="p">}</span>
      <span class="p">]}</span>
    <span class="p">]</span>
    <span class="n">config</span> <span class="o">=</span> <span class="no">Vapor</span><span class="o">.</span><span class="n">load!</span><span class="p">(</span><span class="n">providers</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="o">...</span>
<span class="k">end</span></code></pre></figure>

<p>Sampai di sini kita sudah bisa menggunakan hasil load konfigurasi vapor yang sudah disimpan pada variabel <code class="language-plaintext highlighter-rouge">config</code>, misal butuh nama database tinggal panggil <code class="language-plaintext highlighter-rouge">config.db_name</code>.
Misalnya kita bisa menggunakan pada saat modul <code class="language-plaintext highlighter-rouge">Repo</code> akan diset ke supervisor. Lihat contoh berikut ini:</p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="k">defmodule</span> <span class="no">Myapp</span><span class="o">.</span><span class="no">Application</span> <span class="k">do</span>
  <span class="o">...</span>
  <span class="k">def</span> <span class="n">start</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="n">_args</span><span class="p">)</span> <span class="k">do</span>
    <span class="o">...</span>
    <span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span><span class="no">Myapp</span><span class="o">.</span><span class="no">Repo</span><span class="p">,</span> <span class="p">[</span>
        <span class="ss">database:</span> <span class="n">config</span><span class="o">.</span><span class="n">db_name</span><span class="p">,</span>
        <span class="ss">username:</span> <span class="n">config</span><span class="o">.</span><span class="n">db_user</span><span class="p">,</span>
        <span class="ss">password:</span> <span class="n">config</span><span class="o">.</span><span class="n">db_pass</span><span class="p">,</span> 
        <span class="ss">hostname:</span> <span class="n">config</span><span class="o">.</span><span class="n">db_host</span>
      <span class="p">]},</span>
      <span class="o">...</span>
    <span class="p">]</span>
    <span class="o">...</span>
  <span class="k">end</span>
  <span class="o">...</span>
<span class="k">end</span></code></pre></figure>

<p>Pada contoh kedua kita akan menggunakan file json sebagai tempat untuk menyimpan konfigurasi aplikasi. 
Sebelumnya buat dulu file jsonnya misal namanya <code class="language-plaintext highlighter-rouge">config.json</code> lalu simpan sejajar dengan folder <code class="language-plaintext highlighter-rouge">lib</code>.
Kemudian copy paste kode berikut ini.</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"db_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"db_name"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"db_user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"username"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"db_pass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"password"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"db_host"</span><span class="p">:</span><span class="w"> </span><span class="s2">"localhost"</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>Kemudian masuk ke kode elixir, ganti use modul <code class="language-plaintext highlighter-rouge">Dotenv</code> menjadi <code class="language-plaintext highlighter-rouge">File</code>.</p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="k">defmodule</span> <span class="no">Myapp</span><span class="o">.</span><span class="no">Application</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Vapor</span><span class="o">.</span><span class="no">Provider</span><span class="o">.</span><span class="no">File</span>
  <span class="o">...</span>
  <span class="k">def</span> <span class="n">start</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="n">_args</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">providers</span> <span class="o">=</span><span class="p">[</span>
      <span class="p">%</span><span class="no">File</span><span class="p">{</span>
        <span class="ss">path:</span> <span class="no">System</span><span class="o">.</span><span class="n">get_env</span><span class="p">(</span><span class="s2">"MYAPP_PATH"</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="s2">"config.json"</span><span class="p">,</span>
        <span class="ss">bindings:</span> <span class="p">[</span>
          <span class="p">{</span><span class="ss">:db_name</span><span class="p">,</span> <span class="s2">"db_name"</span><span class="p">},</span>
          <span class="p">{</span><span class="ss">:db_user</span><span class="p">,</span> <span class="s2">"db_user"</span><span class="p">},</span>
          <span class="p">{</span><span class="ss">:db_pass</span><span class="p">,</span> <span class="s2">"db_pass"</span><span class="p">},</span>
          <span class="p">{</span><span class="ss">:db_host</span><span class="p">,</span> <span class="s2">"db_host"</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
    <span class="n">config</span> <span class="o">=</span> <span class="no">Vapor</span><span class="o">.</span><span class="n">load!</span><span class="p">(</span><span class="n">providers</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="o">...</span>
<span class="k">end</span></code></pre></figure>

<p>Setelah fungsi <code class="language-plaintext highlighter-rouge">Vapor.load!()</code> dipanggil dan dimasukkan ke variabel <code class="language-plaintext highlighter-rouge">config</code> maka kita bisa menggunakan
config tersebut kedalam definisi children supervisor.</p>

<figure class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="k">defmodule</span> <span class="no">Myapp</span><span class="o">.</span><span class="no">Application</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Vapor</span><span class="o">.</span><span class="no">Provider</span><span class="o">.</span><span class="no">File</span>
  <span class="o">...</span>
  <span class="k">def</span> <span class="n">start</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="n">_args</span><span class="p">)</span> <span class="k">do</span>
  <span class="o">...</span>
    <span class="n">children</span> <span class="o">=</span> <span class="p">[</span>
      <span class="o">...</span>
      <span class="p">{</span><span class="no">Myapp</span><span class="o">.</span><span class="no">Repo</span><span class="p">,</span> <span class="p">[</span>
          <span class="ss">database:</span> <span class="n">config</span><span class="o">.</span><span class="n">db_name</span><span class="p">,</span>
          <span class="ss">username:</span> <span class="n">config</span><span class="o">.</span><span class="n">db_user</span><span class="p">,</span>
          <span class="ss">password:</span> <span class="n">config</span><span class="o">.</span><span class="n">db_pass</span><span class="p">,</span> 
          <span class="ss">hostname:</span> <span class="n">config</span><span class="o">.</span><span class="n">db_host</span>
        <span class="p">]</span>
      <span class="p">}</span>
      <span class="o">...</span>
    <span class="p">]</span>
  <span class="o">...</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

<p>Untuk menjalankan aplikasi kita perlu menset variabel shell <code class="language-plaintext highlighter-rouge">MYAPP_PATH</code> sesuai dengan lokasi aplikasinya.
Dengan menggunakan config file membuat aplikasi kita akan lebih mudah dalam mengganti konfigurasinya.</p>

<p>Sekian tips dari saya semoga bermanfaat.</p>

  </div><a class="u-url" href="/elixir/2020/08/06/menggunakan-vapor-untuk-konfigurasi-aplikasi-elixir.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper"><div class="footer-col-wrapper">
      <div class="footer-col footer-col-3"><ul class="social-media-list"><li><a href="https://github.com/susilolab"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">susilolab</span></a></li><li><a href="https://instagram.com/mas.agus"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#instagram"></use></svg> <span class="username">mas.agus</span></a></li><li><a href="https://www.twitter.com/susil0"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">susil0</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>&quot;Sebaik-baik manusia adalah yang paling bermanfaat bagi manusia&quot; (HR. Ahmad, ath-Thabrani, ad-Daruqutni)</p>
        <p>&copy;2023&nbsp;Agus Susilo</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
