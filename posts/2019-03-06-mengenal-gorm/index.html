<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Mengenal Gorm - susilolab</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Gorm adalah pustaka ORM untuk golang, ORM itu singkatan dari object-relational mapping walaupun sebenarnya golang bukan bahasa OOP seperti pada umumnya. Alasan kenapa saya menggunakan gorm adalah karena kita tidak perlu merubah tipe data dari mysql ke struk, apalagi jika field struk tersebut ada yang null maka kita harus menggunakan tipe data yang nullable."><meta property="og:image" content><meta property="og:title" content="Mengenal Gorm"><meta property="og:description" content="Gorm adalah pustaka ORM untuk golang, ORM itu singkatan dari object-relational mapping walaupun sebenarnya golang bukan bahasa OOP seperti pada umumnya. Alasan kenapa saya menggunakan gorm adalah karena kita tidak perlu merubah tipe data dari mysql ke struk, apalagi jika field struk tersebut ada yang null maka kita harus menggunakan tipe data yang nullable."><meta property="og:type" content="article"><meta property="og:url" content="https://susilolab.github.io/posts/2019-03-06-mengenal-gorm/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-03-06T08:00:00+00:00"><meta property="article:modified_time" content="2019-03-06T08:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mengenal Gorm"><meta name=twitter:description content="Gorm adalah pustaka ORM untuk golang, ORM itu singkatan dari object-relational mapping walaupun sebenarnya golang bukan bahasa OOP seperti pada umumnya. Alasan kenapa saya menggunakan gorm adalah karena kita tidak perlu merubah tipe data dari mysql ke struk, apalagi jika field struk tersebut ada yang null maka kita harus menggunakan tipe data yang nullable."><script src=https://susilolab.github.io/js/feather.min.js></script><link href=https://susilolab.github.io/css/fonts.eeaf17fd5344c59efcf7fc5c93b898a92cd323eda28c7f1546bbb5f99b42f174.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://susilolab.github.io/css/main.c7dbc780852ad2fc2aae08ae19f1dea5e34c4ef11a83ab0f9b0a025b148de8a1.css></head><body><div class=container><div class=header-wrapper><header class=header-app><div class=main><a href=https://susilolab.github.io/>susilolab</a></div><nav class=navmain><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/portfolio>My Portfolio</a>
<a href=/about>About</a>
<a href=/tags>Tags</a>
<a href=/categories>Categories</a></nav></header></div><div class=border-top></div><div class=content><main><article><div class=title><h1 class=title>Mengenal Gorm</h1><div class=meta><i data-feather=calendar></i> 6 Mar 2019</div><div class=page-categories><a href=/categories/go/>go</a></div></div><section class=body><p>Gorm adalah pustaka ORM untuk golang, ORM itu singkatan dari object-relational mapping walaupun sebenarnya golang bukan bahasa OOP seperti pada umumnya. Alasan kenapa saya menggunakan gorm adalah karena kita tidak perlu merubah tipe data dari mysql ke struk, apalagi jika field struk tersebut ada yang null maka kita harus menggunakan tipe data yang nullable.</p><p>Contohnya string nullable, int nullable dll. Akan sangat repot sekali jika kolomnya banyak, oleh karena itu saya memakai gorm untuk memudahkan hal tersebut.</p><h4 id=install>Install</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go get github.com/jinzhu/gorm</span></span></code></pre></div><p>Untuk contoh saya akan membuat tabel <code>posts</code>, silahkan buat tabel posts dengan aplikasi favorit Anda.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> posts(
</span></span><span style=display:flex><span>  id int(<span style=color:#ae81ff>11</span>) <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>primary</span> <span style=color:#66d9ef>key</span> auto_increment,
</span></span><span style=display:flex><span>  title varchar(<span style=color:#ae81ff>100</span>) <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>  body text,
</span></span><span style=display:flex><span>  published tinyint(<span style=color:#ae81ff>1</span>) unsigned <span style=color:#66d9ef>default</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>);</span></span></code></pre></div><p>Setelah kita selesai membuat tabel posts, maka kita akan membuat folder gorm. Karena akun github saya adalah susilolab maka saya akan membuat folder di <code>github.com/susilolab/blog/gorm</code> dan kita membuat file <code>main.go</code>.</p><h4 id=koneksi-ke-database-mysql>Koneksi ke database mysql</h4><p>kita akan mencoba menghubungkan ke database mysql. Kita juga membutuhkan pustaka driver mysql selain gorm untuk menghubungkan ke database. Ok, pertama kita bikin paket main dan import paket <code>fmt</code>, <code>log</code>, driver <code>mysql</code> dan <code>gorm</code>.</p><p>Dan buat struk <code>Post</code>, struk ini untuk mewakili dari table <code>posts</code>. Struk pada Go konsepnya mirip klas pada PHP. Berikut potongan kodenya:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;log&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>_</span> <span style=color:#e6db74>&#34;github.com/go-sql-driver/mysql&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;github.com/jinzhu/gorm&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Post</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ID</span>        <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Title</span>     <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Body</span>      <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Published</span> <span style=color:#66d9ef>int</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h4 id=koneksi-database>Koneksi database</h4><p>Kemudian pada fungsi main kita buat koneksi ke database dengan memanggil fungsi <code>gorm.Open</code>, fungsi <code>Open</code> akan mengembalikan struk <code>gorm.DB</code> dan <code>err</code>. Jika err tidak sama dengan nil munculkan pesan error dan exit, cukup tuliskan <code>log.Fatalln</code>. <code>Defer.Close()</code> setelah error handling berguna untuk menutup koneksi mysql.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>conn</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>&#34;root:password@tcp(127.0.0.1:3306)/blog?charset=utf8&amp;parseTime=True&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>db</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>gorm</span>.<span style=color:#a6e22e>Open</span>(<span style=color:#e6db74>&#34;mysql&#34;</span>, <span style=color:#a6e22e>conn</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h4 id=query-data>Query Data</h4><p>Kemudian kita bisa memulai query data, kita akan mencoba mengambil semua data yang ada pada tabel <code>posts</code>, perlu di ingat bahwa gorm akan menggangap nama tabel semua dalam bentuk jamak kecuali kita mengaktifkan mode singular atau menyebutkan nama tabel dengan fungsi Table. Misalnya struk <code>User</code> maka nama tabelnya akan dianggap <code>users</code>, struk <code>UserGroup</code> namanya tabelnya akan dianggap <code>user_groups</code> dll. Pertama kita bikin slice <code>Post</code> dengan nama <code>posts</code> untuk menampung datanya.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>posts</span> <span style=color:#f92672>:=</span> make([]<span style=color:#a6e22e>Post</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Find</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>posts</span>).<span style=color:#a6e22e>RecordNotFound</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#e6db74>&#34;record tidak ada&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>val</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>posts</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>val</span>.<span style=color:#a6e22e>Title</span>)
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h4 id=mendapat-data-pertama-dan-terakhir>Mendapat data pertama dan terakhir</h4><p>Untuk mendapatkan record pertama kita bisa menggunakan fungsi First dan untuk data terakhir menggunakan fungsi Last</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>post</span> <span style=color:#a6e22e>Post</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>First</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>post</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>First</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>post</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>lastPost</span> <span style=color:#a6e22e>Post</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Last</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>lastPost</span>)</span></span></code></pre></div><h4 id=insert-data-ke-tabel>Insert data ke tabel</h4><p>Untuk insert data ke tabel ada 2 cara, pertama menggunakan fungsi <code>Create</code> dan yang kedua dengan fungsi <code>NewRecord</code>. Fungsi <code>Create</code> akan mengembalikan struk <code>gorm.DB</code>, untuk melihat errornya bisa melalui property <code>Error</code>. Sedangkan <code>NewRecord</code> akan mengembalikan nilai true jika sukses dan false jika gagal.</p><p>Pertama buat struk Post dan isi field-fieldnya.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>Post</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>Post</span>{<span style=color:#a6e22e>ID</span>: <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>Title</span>: <span style=color:#e6db74>&#34;belajar gorm&#34;</span>, <span style=color:#a6e22e>Body</span>: <span style=color:#e6db74>&#34;awesome&#34;</span>, <span style=color:#a6e22e>Published</span>: <span style=color:#ae81ff>1</span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Create</span>().<span style=color:#a6e22e>Error</span>; <span style=color:#a6e22e>err</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;data sukses disimpan.&#34;</span>);
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h4 id=update>Update</h4><p>Update dapat dilakukan dengan memanggil fungsi <code>Save</code>, setelah kita mencari recordnya terlebih dahulu.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>post</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>Post</span>{}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>First</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>post</span>, <span style=color:#ae81ff>1</span>).<span style=color:#a6e22e>RecordNotFound</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#e6db74>&#34;Record not found.&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>post</span>.<span style=color:#a6e22e>Title</span> = <span style=color:#e6db74>&#34;Belajar ORM dengan Gorm&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>db</span>.<span style=color:#a6e22e>Save</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>post</span>)</span></span></code></pre></div><p>Sekian dari saya dan semoga bermanfaat. Untuk dokumentasi lengkapnya dapat Anda baca disini <a href=https://gorm.io>gorm.io</a>.</p></section><div class=post-tags></div></article></main><footer style=display:flex;justify-content:space-between><div style=width:50%><ul class=social-wrapper><li><a class=soc href=https://github.com/susilolab rel=me title=susilolab><i data-feather=github></i><span class=soc-name>GitHub</span></a></li><li><a class=soc href=https://twitter.com/susil0/ rel=me title=susil0><i data-feather=twitter></i><span class=soc-name>Twitter</span></a></li><li><a class=soc href=https://gitlab.com/susilolab/ rel=me title=susilolab><i data-feather=gitlab></i><span class=soc-name>GitLab</span></a></li></ul></div><div class=footer-info><p>"Sebaik-baik manusia adalah yang paling bermanfaat bagi manusia" (HR. Ahmad, ath-Thabrani, ad-Daruqutni)</p><p>2024 © susilolab | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></p></div></footer><script>feather.replace()</script></div></div></body></html>