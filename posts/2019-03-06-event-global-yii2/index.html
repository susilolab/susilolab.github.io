<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Event Global Yii2 - susilolab</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Event pada yii2 telah ditulis ulang dari versi sebelumnya dan disempurnakan sehingga lebih mudah dan dapat digunakan secara global. Nah kali ini saya ingin berbagai sedikit tip bagaimana membuat event secara global di Yii2. Saya asumsikan bahwa kamu sudah memiliki pengetahuan tentang dasar-dasar PHP7 dan Yii2.
Secara sederhana event pada yii2 mirip event pada jquery dan cara pemakaiannya pun mirip. Untuk listening pada event tertentu kita gunakan on dan untuk mentrigger event menggunakan fungsi trigger. Detil fungsi on dan trigger dapat dilihat dibawah ini:"><meta property="og:image" content><meta property="og:title" content="Event Global Yii2"><meta property="og:description" content="Event pada yii2 telah ditulis ulang dari versi sebelumnya dan disempurnakan sehingga lebih mudah dan dapat digunakan secara global. Nah kali ini saya ingin berbagai sedikit tip bagaimana membuat event secara global di Yii2. Saya asumsikan bahwa kamu sudah memiliki pengetahuan tentang dasar-dasar PHP7 dan Yii2.
Secara sederhana event pada yii2 mirip event pada jquery dan cara pemakaiannya pun mirip. Untuk listening pada event tertentu kita gunakan on dan untuk mentrigger event menggunakan fungsi trigger. Detil fungsi on dan trigger dapat dilihat dibawah ini:"><meta property="og:type" content="article"><meta property="og:url" content="https://susilolab.github.io/posts/2019-03-06-event-global-yii2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-03-06T10:14:42+00:00"><meta property="article:modified_time" content="2019-03-06T10:14:42+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Event Global Yii2"><meta name=twitter:description content="Event pada yii2 telah ditulis ulang dari versi sebelumnya dan disempurnakan sehingga lebih mudah dan dapat digunakan secara global. Nah kali ini saya ingin berbagai sedikit tip bagaimana membuat event secara global di Yii2. Saya asumsikan bahwa kamu sudah memiliki pengetahuan tentang dasar-dasar PHP7 dan Yii2.
Secara sederhana event pada yii2 mirip event pada jquery dan cara pemakaiannya pun mirip. Untuk listening pada event tertentu kita gunakan on dan untuk mentrigger event menggunakan fungsi trigger. Detil fungsi on dan trigger dapat dilihat dibawah ini:"><script src=https://susilolab.github.io/js/feather.min.js></script><link href=https://susilolab.github.io/css/fonts.eeaf17fd5344c59efcf7fc5c93b898a92cd323eda28c7f1546bbb5f99b42f174.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://susilolab.github.io/css/main.c7dbc780852ad2fc2aae08ae19f1dea5e34c4ef11a83ab0f9b0a025b148de8a1.css></head><body><div class=container><div class=header-wrapper><header class=header-app><div class=main><a href=https://susilolab.github.io/>susilolab</a></div><nav class=navmain><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/portfolio>My Portfolio</a>
<a href=/about>About</a>
<a href=/tags>Tags</a>
<a href=/categories>Categories</a></nav></header></div><div class=border-top></div><div class=content><main><article><div class=title><h1 class=title>Event Global Yii2</h1><div class=meta><i data-feather=calendar></i> 6 Mar 2019</div><div class=page-categories><a href=/categories/php/>php</a></div></div><section class=body><p>Event pada <code>yii2</code> telah ditulis ulang dari versi sebelumnya dan disempurnakan sehingga lebih mudah dan dapat digunakan secara global. Nah kali ini saya ingin berbagai sedikit tip bagaimana membuat event secara global di Yii2. Saya asumsikan bahwa kamu sudah memiliki pengetahuan tentang dasar-dasar <strong>PHP7</strong> dan <strong>Yii2</strong>.</p><p>Secara sederhana event pada yii2 mirip event pada <strong>jquery</strong> dan cara pemakaiannya pun mirip. Untuk listening pada event tertentu kita gunakan <strong>on</strong> dan untuk mentrigger event menggunakan fungsi <strong>trigger</strong>. Detil fungsi on dan trigger dapat dilihat dibawah ini:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>Event</span><span style=color:#f92672>::</span><span style=color:#a6e22e>on</span>($class, $name, $handle, $data <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>, $append <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>Event</span><span style=color:#f92672>::</span><span style=color:#a6e22e>trigger</span>($class, $name, $event <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>);</span></span></code></pre></div><p>Tiga parameter utama pada fungsi <code>on</code> wajib ada, sedangkan selebihnya boleh diabaikan. Karena kita akan fokus pada bagaimana menggunakan event yii2 secara global maka kita hanya akan menggunakan 3 parameter pertama. contoh penggunaan event secara umum seperti berikut:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// SiteController.php
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>yii\base\Event</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>EVENT_HELLO</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;hello&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>init</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>parent</span><span style=color:#f92672>::</span><span style=color:#a6e22e>init</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Event</span><span style=color:#f92672>::</span><span style=color:#a6e22e>on</span>(<span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>className</span>(), <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EVENT_HELLO</span>, [<span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>className</span>(), <span style=color:#e6db74>&#39;helloLog&#39;</span>]);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>actionIndex</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  $event <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Event</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Event</span><span style=color:#f92672>::</span><span style=color:#a6e22e>trigger</span>(<span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>className</span>(), <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EVENT_HELLO</span>, $event);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> $this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>render</span>(<span style=color:#e6db74>&#39;index&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>helloLog</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Yii</span><span style=color:#f92672>::</span><span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;---Hello world---&#39;</span>); 
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#f92672>...</span></span></span></code></pre></div><p>Pada contoh di atas kita mengimport klas <code>Event</code> kemudian membuat konstanta nama event. Lalu pada fungsi <code>init</code> kita mendaftarkan event melalui fungsi <code>on</code> dengan nama fungsi yang akan dijalankan setelah event ditrigger yaitu <code>helloLog</code>. Selanjutnya pada fungsi <code>actionIndex</code> kita mentrigger event <code>EVENT_HELLO</code> memakai fungsi trigger.</p><p>Perhatikan parameter ketiga, karena fungsi <code>helloLog</code> bertipe static maka nama klasnya menggunakan <code>self::className</code>. Jika menggunakan fungsi yang bukan static kita bisa menggunakan <code>$this</code> seperti ini:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>Event</span><span style=color:#f92672>::</span><span style=color:#a6e22e>on</span>(<span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>className</span>(), <span style=color:#a6e22e>self</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EVENT_HELLO</span>, [$this, <span style=color:#e6db74>&#39;helloLog&#39;</span>]);</span></span></code></pre></div><p>Kemudian jalankan dengan mengakses controller site, jika tidak ada error maka akan ada log error dengan pesan hello world pada file <code>runtime/logs/app.log</code> seperti berikut ini:</p><p><img src=/img/001-2019-03-06-event-globalyii2.png alt=event-global></p><p>Semoga dengan penjelasan dan contoh di atas kita sudah bisa memahami dasar-dasar event pada <code>yii2</code>, sekarang kita bikin event listenernya secara global sehingga kita dapat memicu/mentriggernya dari mana saja(model/controller/module). Agar event dapat didaftarkan secara global pada saat aplikasinya jalan maka kita akan menggunakan BootstrapInterface. kita akan bikin klas implementasi dari BootstrapInterface.</p><p>Pertama kita bikin klas dengan nama <code>EventAutoLoader.php</code> pada folder <code>nama_app/components</code>, Klas ini berguna agar aplikasi dapat memuat konfigurasi event-event pada saat proses booting aplikasi. klas ini turunan dari <code>BootstrapInterface</code> yang hanya memiliki satu definisi fungsi yang harus di implementasikan pada klas turunan.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>app\components</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Yii</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>yii\base\BootstrapInterface</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>yii\base\Event</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EventAutoLoader</span> <span style=color:#66d9ef>implements</span> <span style=color:#a6e22e>BootstrapInterface</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>bootstrap</span>($app)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    $eventConfigFile <span style=color:#f92672>=</span> <span style=color:#66d9ef>require</span>(<span style=color:#a6e22e>Yii</span><span style=color:#f92672>::</span><span style=color:#a6e22e>getAlias</span>(<span style=color:#e6db74>&#39;@app&#39;</span>) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/config/event-config.php&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>foreach</span> ($eventConfigFile <span style=color:#66d9ef>as</span> $config) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Event</span><span style=color:#f92672>::</span><span style=color:#a6e22e>on</span>($config[<span style=color:#e6db74>&#39;class&#39;</span>], $config[<span style=color:#e6db74>&#39;event&#39;</span>], $config[<span style=color:#e6db74>&#39;callback&#39;</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>Kemudian buka file <code>config/web.php</code> dan tambahkan klas yang baru saja kita buat pada config <code>bootstrap</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#e6db74>&#39;bootstrap&#39;</span> <span style=color:#f92672>=&gt;</span> [
</span></span><span style=display:flex><span>  <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;app\components\EventAutoLoader&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>],</span></span></code></pre></div><p>Tak lupa buat file dengan nama event-config.php pada folder config untuk menyimpan semua event dan event handler. Dan isinya kurang lebih seperti ini:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>app\controllers\SiteController</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>return</span> [
</span></span><span style=display:flex><span>  [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;class&#39;</span>    <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>SiteController</span><span style=color:#f92672>::</span><span style=color:#a6e22e>className</span>(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;event&#39;</span>    <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>SiteController</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EVENT_HELLO</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;callback&#39;</span> <span style=color:#f92672>=&gt;</span> [<span style=color:#a6e22e>SiteController</span><span style=color:#f92672>::</span><span style=color:#a6e22e>className</span>(), <span style=color:#e6db74>&#39;helloLog&#39;</span>],
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>];</span></span></code></pre></div><p>Sampai tahap ini kita sudah mendaftarkan event secara global dan event tersebut dapat kita dari mana saja, karena klas <code>EventAutoLoader</code> akan dijalankan pada saat aplikasi booting pertama kali. Untuk memastikan bahwa event dapat dipanggil dari mana saja, kita akan membuat controller baru dengan nama <code>HelloController</code> dan mentrigger event yang ada di <code>SiteController</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> <span style=color:#a6e22e>app\controllers</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>Yii</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>yii\web\Controller</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>yii\base\Event</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>use</span> <span style=color:#a6e22e>app\controllers\SiteController</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>HelloController</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>Controller</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>actionIndex</span>()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      $event <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Event</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Event</span><span style=color:#f92672>::</span><span style=color:#a6e22e>trigger</span>(<span style=color:#a6e22e>SiteController</span><span style=color:#f92672>::</span><span style=color:#a6e22e>className</span>(), <span style=color:#a6e22e>SiteController</span><span style=color:#f92672>::</span><span style=color:#a6e22e>EVENT_HELLO</span>, $event);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>Kemudian akses hello controller melalui browser, jika semua lancar maka akan ada pesan Hello world di <code>app.log</code></p><p><img src=/img/002-2019-03-06-event-globalyii2.png alt=event-global></p><p>Sekian untuk artikel kali semoga bermanfaat. Insya Allah pada artikel berikutnya saya akan membahas sedikit bagaimana melewatkan data pada event yang telah kita buat. Apabila kamu mempunyai saran dan kritik untuk artikel jangan sungkan2 untuk berkomentar dibawah.</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/php>php</a></li><li><a href=/tags/yii>Yii</a></li></ul></nav></div></article></main><footer style=display:flex;justify-content:space-between><div style=width:50%><ul class=social-wrapper><li><a class=soc href=https://github.com/susilolab rel=me title=susilolab><i data-feather=github></i><span class=soc-name>GitHub</span></a></li><li><a class=soc href=https://twitter.com/susil0/ rel=me title=susil0><i data-feather=twitter></i><span class=soc-name>Twitter</span></a></li><li><a class=soc href=https://gitlab.com/susilolab/ rel=me title=susilolab><i data-feather=gitlab></i><span class=soc-name>GitLab</span></a></li></ul></div><div class=footer-info><p>"Sebaik-baik manusia adalah yang paling bermanfaat bagi manusia" (HR. Ahmad, ath-Thabrani, ad-Daruqutni)</p><p>2024 © susilolab | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></p></div></footer><script>feather.replace()</script></div></div></body></html>