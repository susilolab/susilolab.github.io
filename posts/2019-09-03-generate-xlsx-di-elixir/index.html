<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Generate file xls di Elixir - susilolab</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Tips singkat bagaimana mengenerate file xlsx di Elixir dengan paket elixlsx. Pertama tambahkan ektensi ke file mix.exs pada bagian fungsi deps"><meta property="og:image" content><meta property="og:title" content="Generate file xls di Elixir"><meta property="og:description" content="Tips singkat bagaimana mengenerate file xlsx di Elixir dengan paket elixlsx. Pertama tambahkan ektensi ke file mix.exs pada bagian fungsi deps"><meta property="og:type" content="article"><meta property="og:url" content="https://susilolab.github.io/posts/2019-09-03-generate-xlsx-di-elixir/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-09-03T09:00:00+00:00"><meta property="article:modified_time" content="2019-09-03T09:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Generate file xls di Elixir"><meta name=twitter:description content="Tips singkat bagaimana mengenerate file xlsx di Elixir dengan paket elixlsx. Pertama tambahkan ektensi ke file mix.exs pada bagian fungsi deps"><script src=https://susilolab.github.io/js/feather.min.js></script><link href=https://susilolab.github.io/css/fonts.eeaf17fd5344c59efcf7fc5c93b898a92cd323eda28c7f1546bbb5f99b42f174.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://susilolab.github.io/css/main.c7dbc780852ad2fc2aae08ae19f1dea5e34c4ef11a83ab0f9b0a025b148de8a1.css></head><body><div class=container><div class=header-wrapper><header class=header-app><div class=main><a href=https://susilolab.github.io/>susilolab</a></div><nav class=navmain><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/portfolio>My Portfolio</a>
<a href=/about>About</a>
<a href=/tags>Tags</a>
<a href=/categories>Categories</a></nav></header></div><div class=border-top></div><div class=content><main><article><div class=title><h1 class=title>Generate file xls di Elixir</h1><div class=meta><i data-feather=calendar></i> 3 Sep 2019</div><div class=page-categories><a href=/categories/elixir/>elixir</a></div></div><section class=body><p>Tips singkat bagaimana mengenerate file <strong>xlsx</strong> di Elixir dengan paket <code>elixlsx</code>. Pertama tambahkan ektensi ke file <code>mix.exs</code> pada bagian fungsi <code>deps</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#66d9ef>defp</span> deps <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    {<span style=color:#e6db74>:elixlsx</span>, <span style=color:#e6db74>&#34;~&gt; 0.4.2&#34;</span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span></span></span></code></pre></div><p>Kemudian jalankan perintah berikut diterminal kamu</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mix deps.get</span></span></code></pre></div><p>Setelah itu baru kita bisa mengenerate file xls. saya asumsikan bahwa kamu sudah membuat modul jadi tinggal tambahkan fungsi download. Misal nama modulnya <code>Playgorund</code> lalu tambahkan alias <code>Elixlsx.Sheet</code> dan <code>Elixlsx.Workbook</code> pada bagian setelah definisi modul.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#66d9ef>defmodule</span> <span style=color:#a6e22e>Playground</span> <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>alias</span> <span style=color:#a6e22e>Elixlsx</span><span style=color:#f92672>.</span>{<span style=color:#a6e22e>Workbook</span>, <span style=color:#a6e22e>Sheet</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> download <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>        rows <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>            %{<span style=color:#e6db74>id</span>: <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>name</span>: <span style=color:#e6db74>&#34;PHP&#34;</span>},
</span></span><span style=display:flex><span>            %{<span style=color:#e6db74>id</span>: <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>name</span>: <span style=color:#e6db74>&#34;Go&#34;</span>},
</span></span><span style=display:flex><span>            %{<span style=color:#e6db74>id</span>: <span style=color:#ae81ff>3</span>, <span style=color:#e6db74>name</span>: <span style=color:#e6db74>&#34;Javascript&#34;</span>},
</span></span><span style=display:flex><span>            %{<span style=color:#e6db74>id</span>: <span style=color:#ae81ff>4</span>, <span style=color:#e6db74>name</span>: <span style=color:#e6db74>&#34;Elixir&#34;</span>},
</span></span><span style=display:flex><span>            %{<span style=color:#e6db74>id</span>: <span style=color:#ae81ff>5</span>, <span style=color:#e6db74>name</span>: <span style=color:#e6db74>&#34;Rust&#34;</span>}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        sheets <span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span>            rows
</span></span><span style=display:flex><span>            <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Stream</span><span style=color:#f92672>.</span>with_index
</span></span><span style=display:flex><span>            <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Enum</span><span style=color:#f92672>.</span>reduce(%<span style=color:#a6e22e>Sheet</span>{}, <span style=color:#66d9ef>fn</span>({row, idx}, acc) <span style=color:#f92672>-&gt;</span> 
</span></span><span style=display:flex><span>                acc 
</span></span><span style=display:flex><span>                <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Sheet</span><span style=color:#f92672>.</span>set_at(idx, <span style=color:#ae81ff>0</span>, row<span style=color:#f92672>.</span>id) 
</span></span><span style=display:flex><span>                <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Sheet</span><span style=color:#f92672>.</span>set_at(idx, <span style=color:#ae81ff>1</span>, row<span style=color:#f92672>.</span>name)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>end</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Workbook</span><span style=color:#f92672>.</span>append_sheet(%<span style=color:#a6e22e>Workbook</span>{}, sheets) <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Elixlsx</span><span style=color:#f92672>.</span>write_to(<span style=color:#e6db74>&#34;todos.xlsx&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span></span></span></code></pre></div><p>Pada fungsi <code>download</code> kita membuat variabel <code>rows</code> menyimpan struct yang berisi <code>id</code> dan <code>name</code>. Kemudian variabel <code>sheets</code> menyimpan daftar <code>Sheet</code>. Pertama <code>rows</code> kita kirim ke pemipaan(<code>|></code>) <code>Stream.with_index</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span>rows <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Stream</span><span style=color:#f92672>.</span>with_index </span></span></code></pre></div><p><code>Stream.with_index</code> berfungsi membuat stream data dengan setiap datanya terdiri dari tuple <code>data</code> dan <code>index</code> seperti ini <code>{data, index}</code> sehingga <code>index</code> bisa digunakan untuk isian baris pada sheet.</p><p>Hasil dari <code>Stream.with_index</code> kita pipakan lagi ke fungsi sebelah kanan yaitu <code>Enum.reduce</code>, fungsi ini akan mengembalikan daftar sheet. Fungsi ini parameter kedua berupa struct <code>%Sheet{}</code> sebagai accumulator/variabel yang akan menyimpan hasil reduce, parameter ketiga berupa fungsi <code>data</code> dan <code>acc</code> kemudian didalamnya akumulator akan diisi dengan data dari <code>rows</code> di atas. <code>Sheet.set_at(idx, 0, row.id)</code> fungsi akan menset data pada baris <code>idx</code>, kolom <code>0</code> dengan value berupa <code>row.id</code> lalu fungsi yang kedua menset data berupa <code>row.name</code> sampai data pada <code>rows</code> habis.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#a6e22e>Enum</span><span style=color:#f92672>.</span>reduce(%<span style=color:#a6e22e>Sheet</span>{}, <span style=color:#66d9ef>fn</span>({row, idx}, acc) <span style=color:#f92672>-&gt;</span> 
</span></span><span style=display:flex><span>    acc 
</span></span><span style=display:flex><span>    <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Sheet</span><span style=color:#f92672>.</span>set_at(idx, <span style=color:#ae81ff>0</span>, row<span style=color:#f92672>.</span>id) 
</span></span><span style=display:flex><span>    <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Sheet</span><span style=color:#f92672>.</span>set_at(idx, <span style=color:#ae81ff>1</span>, row<span style=color:#f92672>.</span>name)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>)</span></span></code></pre></div><p>Terakhir <code>sheets</code> akan ditambahkan ke <code>Workbook</code> lalu dipipakan ke fungsi <code>write_to</code> untuk disimpan menjadi file <code>todos.xlsx</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elixir data-lang=elixir><span style=display:flex><span><span style=color:#a6e22e>Workbook</span><span style=color:#f92672>.</span>append_sheet(%<span style=color:#a6e22e>Workbook</span>{}, sheets) <span style=color:#f92672>|&gt;</span> <span style=color:#a6e22e>Elixlsx</span><span style=color:#f92672>.</span>write_to(<span style=color:#e6db74>&#34;todos.xlsx&#34;</span>)</span></span></code></pre></div><p>Kemudian buka <code>iex</code> diterminal kamu, lalu seperti biasa ketikan alias <code>Playgorund</code> baru jalankan fungsi download.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ iex
</span></span><span style=display:flex><span>iex<span style=color:#f92672>(</span>1<span style=color:#f92672>)</span>&gt; alias Playground
</span></span><span style=display:flex><span>iex<span style=color:#f92672>(</span>2<span style=color:#f92672>)</span>&gt; Playground.download<span style=color:#f92672>()</span></span></span></code></pre></div><p>sekian.</p></section><div class=post-tags></div></article></main><footer style=display:flex;justify-content:space-between><div style=width:50%><ul class=social-wrapper><li><a class=soc href=https://github.com/susilolab rel=me title=susilolab><i data-feather=github></i><span class=soc-name>GitHub</span></a></li><li><a class=soc href=https://twitter.com/susil0/ rel=me title=susil0><i data-feather=twitter></i><span class=soc-name>Twitter</span></a></li><li><a class=soc href=https://gitlab.com/susilolab/ rel=me title=susilolab><i data-feather=gitlab></i><span class=soc-name>GitLab</span></a></li></ul></div><div class=footer-info><p>"Sebaik-baik manusia adalah yang paling bermanfaat bagi manusia" (HR. Ahmad, ath-Thabrani, ad-Daruqutni)</p><p>2024 © susilolab | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></p></div></footer><script>feather.replace()</script></div></div></body></html>